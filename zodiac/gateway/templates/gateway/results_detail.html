{% extends "gateway/base.html" %}

{% block h1_title %}
  Result Detail
  <small>{{object.task_result.date_done}}</small>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-12">
    <div class="box box-primary">
      <div class="box-body">
        <dl>
          <dt>Identifier</dt>
          <dd>{{object.async_result_id}}</dd>
          {% if object.service %}
          <dt>Service</dt>
          <dd><a href="{% url 'services-detail' pk=object.service.pk %}">{{object.service.name}}</a></dd>
          {% endif %}
          <dt>URL</dt>
          <dd>{{object.request_url}}</dd>
          <dt>Arguments</dt>
          <dd><pre>{{object.task_result.task_args}}</pre></dd>
          <dt>Keyword Arguments</dt>
          <dd><pre>{{object.task_result.task_kwargs}}</pre></dd>
          <dt>Result</dt>
          <dd><pre><code>{{ object.task_result.result }}</code></pre></dd>
          {% if object.task_result.traceback %}
            <dt>Traceback</dt>
            <dd><pre><code>{{object.task_result.traceback }}</code></pre></dd>
          {% endif %}
        </dl>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script type="text/javascript">
  var trigger_url = '{{ object.get_trigger_url }}'
  $(document).ready(function(){
    $('#trigger-service-btn').click(function(){
      $.get(trigger_url,{}, function(resp){
        if(resp.SUCCESS == 1){
          alert('it worked, request queued')
        }
      });
    })
  });

</script>
{% endblock %}
